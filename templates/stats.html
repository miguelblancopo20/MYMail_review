{% extends "base.html" %}
{% block body %}
  <header class="topbar">
    <div class="topbar-left">
      <div class="topbar-title">Stats</div>
    </div>
    <div class="topbar-right">
      <div class="pill">{{ current_user }}</div>
      <a class="btn btn-ghost" href="{{ url_for('review') }}">Volver</a>
      <a class="btn btn-ghost" href="{{ url_for('logout') }}">Salir</a>
    </div>
  </header>

  <main class="page page--full">
    {% if error %}
      <div class="alert">{{ error }}</div>
    {% endif %}

    <div class="stats-grid">
      <div class="card stat">
        <div class="stat-k">Revisiones (últimos {{ days }} días)</div>
        <div class="stat-v">{{ total_resultados }}</div>
      </div>
      <div class="card stat">
        <div class="stat-k">Descartes (últimos {{ days }} días)</div>
        <div class="stat-v">{{ total_descartes }}</div>
      </div>
      <div class="card stat">
        <div class="stat-k">KO% (sobre revisiones)</div>
        <div class="stat-v">{{ ko_rate }}</div>
      </div>
      <div class="card stat">
        <div class="stat-k">DUDA</div>
        <div class="stat-v">{{ duda_count }}</div>
      </div>
    </div>

    <div class="layout" style="grid-template-columns: 1fr 1fr; height:auto">
      <section class="section section--review">
        <div class="section-title">Estados</div>
        <div class="kv-list">
          {% for k,v in by_status %}
            <div class="kv-row"><div class="k">{{ k }}</div><div class="v">{{ v }}</div></div>
          {% endfor %}
        </div>
      </section>

      <section class="section section--act">
        <div class="section-title">Top Automatismos (revisión)</div>
        <div class="kv-list">
          {% for k,v in top_automatismos %}
            <div class="kv-row"><div class="k">{{ k }}</div><div class="v">{{ v }}</div></div>
          {% endfor %}
        </div>
      </section>

      <section class="section section--agent">
        <div class="section-title">Revisiones por usuario</div>
        <div class="kv-list">
          {% for k,v in by_user %}
            <div class="kv-row"><div class="k">{{ k }}</div><div class="v">{{ v }}</div></div>
          {% endfor %}
        </div>
      </section>

      <section class="section section--mail">
        <div class="section-title">Actividad diaria</div>
        <div class="kv-list">
          {% for k,v in by_day %}
            <div class="kv-row"><div class="k">{{ k }}</div><div class="v">{{ v }}</div></div>
          {% endfor %}
        </div>
      </section>
    </div>
  </main>
{% endblock %}

